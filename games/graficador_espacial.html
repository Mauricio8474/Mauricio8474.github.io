<!DOCTYPE html>
<html lang="es">
<head>
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ1QWD1TCC"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XZ1QWD1TCC');
</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Graficador Espacial - Grado 9¬∞</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600;700;900&family=Roboto:wght@300;400;500;600&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a3e 50%, #2d1b69 100%);
            min-height: 100vh;
            color: white;
            overflow-x: hidden;
        }

        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle 3s infinite ease-in-out;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.2); }
        }

        .container {
            position: relative;
            z-index: 2;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            border: 2px solid rgba(0, 255, 255, 0.3);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        .title {
            font-family: 'Orbitron', monospace;
            font-size: 3em;
            font-weight: 900;
            background: linear-gradient(45deg, #00ffff, #ff00ff, #ffff00);
            background-size: 200% 200%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: gradientShift 3s ease-in-out infinite;
            text-shadow: 0 0 30px rgba(0, 255, 255, 0.5);
        }

        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .subtitle {
            margin-top: 15px;
            font-size: 1.3em;
            color: #b8c6db;
            font-weight: 300;
        }

        .game-stats {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            flex-wrap: wrap;
            gap: 15px;
        }

        .stat-card {
            background: linear-gradient(45deg, rgba(0, 255, 255, 0.2), rgba(255, 0, 255, 0.2));
            padding: 15px 25px;
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(5px);
            min-width: 150px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 255, 255, 0.3);
        }

        .stat-number {
            font-family: 'Orbitron', monospace;
            font-size: 1.8em;
            font-weight: 700;
            color: #00ffff;
        }

        .stat-label {
            font-size: 0.9em;
            margin-top: 5px;
            color: #b8c6db;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-top: 30px;
        }

        .control-panel {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 30px;
            border: 2px solid rgba(0, 255, 255, 0.3);
            height: fit-content;
        }

        .graph-container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 30px;
            border: 2px solid rgba(255, 0, 255, 0.3);
            position: relative;
            overflow: hidden;
        }

        .section-title {
            font-family: 'Orbitron', monospace;
            font-size: 1.5em;
            margin-bottom: 20px;
            color: #00ffff;
            text-align: center;
        }

        .function-selector {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            justify-content: center;
        }

        .function-btn {
            padding: 12px 20px;
            border: 2px solid #00ffff;
            background: transparent;
            color: #00ffff;
            border-radius: 25px;
            cursor: pointer;
            font-family: 'Orbitron', monospace;
            font-weight: 600;
            transition: all 0.3s ease;
            font-size: 1em;
        }

        .function-btn.active {
            background: linear-gradient(45deg, #00ffff, #ff00ff);
            color: black;
            box-shadow: 0 5px 15px rgba(0, 255, 255, 0.4);
            transform: translateY(-2px);
        }

        .function-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 255, 255, 0.3);
        }

        .parameter-controls {
            margin-bottom: 25px;
        }

        .parameter-group {
            margin-bottom: 20px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .parameter-label {
            display: block;
            margin-bottom: 10px;
            font-weight: 500;
            color: #b8c6db;
        }

        .parameter-input {
            width: 100%;
            padding: 12px;
            border: 2px solid rgba(0, 255, 255, 0.5);
            background: rgba(0, 0, 0, 0.5);
            color: white;
            border-radius: 8px;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        .parameter-input:focus {
            outline: none;
            border-color: #00ffff;
            box-shadow: 0 0 10px rgba(0, 255, 255, 0.3);
        }

        .slider-container {
            position: relative;
            margin: 15px 0;
        }

        .slider {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: linear-gradient(90deg, #ff00ff, #00ffff);
            outline: none;
            opacity: 0.8;
            transition: opacity 0.3s;
        }

        .slider:hover {
            opacity: 1;
        }

        .slider::-webkit-slider-thumb {
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #00ffff;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
        }

        .canvas-container {
            position: relative;
            width: 100%;
            height: 500px;
            background: radial-gradient(circle at center, rgba(0, 50, 100, 0.3), rgba(0, 0, 50, 0.8));
            border-radius: 15px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            overflow: hidden;
        }

        #graphCanvas {
            width: 100%;
            height: 100%;
            border-radius: 13px;
        }

        .challenge-section {
            margin-top: 30px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 30px;
            border: 2px solid rgba(255, 255, 0, 0.3);
            grid-column: 1 / -1;
        }

        .challenge-card {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
        }

        .challenge-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255, 255, 0, 0.2);
        }

        .challenge-title {
            font-family: 'Orbitron', monospace;
            font-size: 1.3em;
            margin-bottom: 15px;
            color: #ffff00;
        }

        .challenge-description {
            margin-bottom: 15px;
            line-height: 1.6;
            color: #b8c6db;
        }

        .check-btn {
            background: linear-gradient(45deg, #00ff00, #00ffff);
            color: black;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            font-family: 'Orbitron', monospace;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-right: 15px;
        }

        .check-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0, 255, 0, 0.4);
        }

        .hint-btn {
            background: transparent;
            color: #ffff00;
            border: 2px solid #ffff00;
            padding: 10px 20px;
            border-radius: 20px;
            font-family: 'Orbitron', monospace;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .hint-btn:hover {
            background: rgba(255, 255, 0, 0.1);
            transform: scale(1.05);
        }

        .feedback {
            margin-top: 15px;
            padding: 15px;
            border-radius: 10px;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .feedback.correct {
            background: rgba(0, 255, 0, 0.2);
            color: #00ff00;
            border: 1px solid #00ff00;
        }

        .feedback.incorrect {
            background: rgba(255, 0, 0, 0.2);
            color: #ff6b6b;
            border: 1px solid #ff6b6b;
        }

        .current-equation {
            text-align: center;
            font-family: 'Orbitron', monospace;
            font-size: 1.5em;
            margin: 20px 0;
            padding: 15px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            color: #00ffff;
            border: 2px solid rgba(0, 255, 255, 0.3);
        }

        .achievements {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .achievement {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            color: black;
            border: 3px solid #ffd700;
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.5);
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { box-shadow: 0 0 15px rgba(255, 215, 0, 0.5); }
            to { box-shadow: 0 0 25px rgba(255, 215, 0, 0.8); }
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .title {
                font-size: 2em;
            }
            
            .game-stats {
                justify-content: center;
            }
            
            .function-selector {
                flex-direction: column;
                align-items: center;
            }
            
            .canvas-container {
                height: 400px;
            }
        }
    </style>
</head>
<body>
    <div class="stars"></div>
    
    <div class="container">
        <div class="header">
            <h1 class="title">GRAFICADOR ESPACIAL</h1>
            <p class="subtitle">Explora las funciones lineales y cuadr√°ticas en el espacio matem√°tico</p>
            
            <div class="game-stats">
                <div class="stat-card">
                    <div class="stat-number" id="score">0</div>
                    <div class="stat-label">Puntos</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="level">1</div>
                    <div class="stat-label">Nivel</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="challenges">0</div>
                    <div class="stat-label">Desaf√≠os</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="streak">0</div>
                    <div class="stat-label">Racha</div>
                </div>
            </div>
            
            <div class="achievements" id="achievements"></div>
        </div>

        <div class="main-content">
            <div class="control-panel">
                <h2 class="section-title">Panel de Control</h2>
                
                <div class="function-selector">
                    <button class="function-btn active" onclick="selectFunction('linear')" id="linearBtn">
                        Lineal
                    </button>
                    <button class="function-btn" onclick="selectFunction('quadratic')" id="quadraticBtn">
                        Cuadr√°tica
                    </button>
                </div>

                <div class="current-equation" id="currentEquation">
                    y = x
                </div>

                <div class="parameter-controls" id="parameterControls">
                    <div class="parameter-group">
                        <label class="parameter-label">Pendiente (m)</label>
                        <input type="range" class="slider" min="-5" max="5" step="0.1" value="1" 
                               onInput="updateParameter('m', this.value)" id="mSlider">
                        <input type="number" class="parameter-input" min="-5" max="5" step="0.1" value="1" 
                               onInput="updateParameter('m', this.value)" id="mInput">
                    </div>
                    
                    <div class="parameter-group">
                        <label class="parameter-label">Intersecci√≥n Y (b)</label>
                        <input type="range" class="slider" min="-10" max="10" step="0.1" value="0" 
                               onInput="updateParameter('b', this.value)" id="bSlider">
                        <input type="number" class="parameter-input" min="-10" max="10" step="0.1" value="0" 
                               onInput="updateParameter('b', this.value)" id="bInput">
                    </div>
                </div>
            </div>

            <div class="graph-container">
                <h2 class="section-title">Plano Cartesiano Espacial</h2>
                <div class="canvas-container">
                    <canvas id="graphCanvas" width="600" height="500"></canvas>
                </div>
            </div>
        </div>

        <div class="challenge-section">
            <h2 class="section-title">Misi√≥n Actual</h2>
            <div class="challenge-card" id="currentChallenge">
                <div class="challenge-title">Desaf√≠o 1: Primera Funci√≥n Lineal</div>
                <div class="challenge-description">
                    Crea una funci√≥n lineal que pase por los puntos (0, 2) y (2, 6).
                    <br><strong>Pista:</strong> Recuerda que en una funci√≥n lineal y = mx + b, 'm' es la pendiente y 'b' es donde la l√≠nea cruza el eje Y.
                </div>
                <button class="check-btn" onclick="checkChallenge()">Verificar Soluci√≥n</button>
                <button class="hint-btn" onclick="showHint()">üí° Pista</button>
                <div class="feedback" id="feedback"></div>
            </div>
        </div>
    </div>

    <script>
         // Redirige si no hay usuario autenticado
        if (!localStorage.getItem('currentUser') && !sessionStorage.getItem('currentUser')) {
            window.location.href = "complete-login-html.html";
        }
        // Variables globales del juego
        let currentFunction = 'linear';
        let parameters = { m: 1, b: 0, a: 1, h: 0, k: 0 };
        let gameState = {
            score: 0,
            level: 1,
            challenges: 0,
            streak: 0,
            currentChallenge: 0
        };

        // Desaf√≠os del juego
        const challenges = [
            {
                title: "Desaf√≠o 1: Primera Funci√≥n Lineal",
                description: "Crea una funci√≥n lineal que pase por los puntos (0, 2) y (2, 6).",
                hint: "Si la l√≠nea pasa por (0, 2), entonces b = 2. Para encontrar m, usa la f√≥rmula: m = (y2-y1)/(x2-x1)",
                type: "linear",
                target: { m: 2, b: 2 },
                tolerance: 0.1,
                points: 100
            },
            {
                title: "Desaf√≠o 2: Pendiente Negativa",
                description: "Crea una funci√≥n lineal con pendiente -1.5 que pase por el punto (0, 4).",
                hint: "Una pendiente negativa significa que la l√≠nea baja de izquierda a derecha.",
                type: "linear",
                target: { m: -1.5, b: 4 },
                tolerance: 0.1,
                points: 150
            },
            {
                title: "Desaf√≠o 3: Tu Primera Par√°bola",
                description: "Crea una funci√≥n cuadr√°tica y = x¬≤ + 3.",
                hint: "En la forma y = ax¬≤ + bx + c, necesitas a = 1, b = 0, c = 3.",
                type: "quadratic",
                target: { a: 1, b: 0, c: 3 },
                tolerance: 0.1,
                points: 200
            },
            {
                title: "Desaf√≠o 4: Par√°bola Invertida",
                description: "Crea una par√°bola que se abra hacia abajo con v√©rtice en (0, 5).",
                hint: "Para que se abra hacia abajo, el coeficiente 'a' debe ser negativo.",
                type: "quadratic",
                target: { a: -1, b: 0, c: 5 },
                tolerance: 0.1,
                points: 250
            },
            {
                title: "Desaf√≠o 5: Par√°bola Desplazada",
                description: "Crea la funci√≥n cuadr√°tica y = 2(x - 1)¬≤ - 3.",
                hint: "Esta es la forma v√©rtice: y = a(x - h)¬≤ + k, donde (h, k) es el v√©rtice.",
                type: "quadratic",
                target: { a: 2, h: 1, k: -3 },
                tolerance: 0.1,
                points: 300
            }
        ];

        // Logros disponibles
        const achievements = [
            { id: 'first_graph', name: 'Primer Gr√°fico', icon: 'üìä', unlocked: false },
            { id: 'linear_master', name: 'Maestro Lineal', icon: 'üìè', unlocked: false },
            { id: 'curve_explorer', name: 'Explorador de Curvas', icon: 'üåä', unlocked: false },
            { id: 'perfect_streak', name: 'Racha Perfecta', icon: 'üî•', unlocked: false },
            { id: 'space_navigator', name: 'Navegante Espacial', icon: 'üöÄ', unlocked: false }
        ];

        // Inicializaci√≥n
        document.addEventListener('DOMContentLoaded', function() {
            createStars();
            initializeCanvas();
            updateGraph();
            updateChallenge();
            updateUI();
        });

        // Crear estrellas de fondo
        function createStars() {
            const starsContainer = document.querySelector('.stars');
            for (let i = 0; i < 100; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.width = Math.random() * 3 + 1 + 'px';
                star.style.height = star.style.width;
                star.style.animationDelay = Math.random() * 3 + 's';
                starsContainer.appendChild(star);
            }
        }

        // Configurar canvas
        function initializeCanvas() {
            const canvas = document.getElementById('graphCanvas');
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width;
            canvas.height = rect.height;
        }

        // Seleccionar tipo de funci√≥n
        function selectFunction(type) {
            currentFunction = type;
            
            // Actualizar botones
            document.getElementById('linearBtn').classList.remove('active');
            document.getElementById('quadraticBtn').classList.remove('active');
            document.getElementById(type + 'Btn').classList.add('active');
            
            // Actualizar controles de par√°metros
            updateParameterControls();
            updateGraph();
            updateEquation();
        }

        // Actualizar controles de par√°metros
        function updateParameterControls() {
            const controlsContainer = document.getElementById('parameterControls');
            
            if (currentFunction === 'linear') {
                controlsContainer.innerHTML = `
                    <div class="parameter-group">
                        <label class="parameter-label">Pendiente (m)</label>
                        <input type="range" class="slider" min="-5" max="5" step="0.1" value="${parameters.m}" 
                               onInput="updateParameter('m', this.value)" id="mSlider">
                        <input type="number" class="parameter-input" min="-5" max="5" step="0.1" value="${parameters.m}" 
                               onInput="updateParameter('m', this.value)" id="mInput">
                    </div>
                    
                    <div class="parameter-group">
                        <label class="parameter-label">Intersecci√≥n Y (b)</label>
                        <input type="range" class="slider" min="-10" max="10" step="0.1" value="${parameters.b}" 
                               onInput="updateParameter('b', this.value)" id="bSlider">
                        <input type="number" class="parameter-input" min="-10" max="10" step="0.1" value="${parameters.b}" 
                               onInput="updateParameter('b', this.value)" id="bInput">
                    </div>
                `;
            } else {
                controlsContainer.innerHTML = `
                    <div class="parameter-group">
                        <label class="parameter-label">Coeficiente a</label>
                        <input type="range" class="slider" min="-3" max="3" step="0.1" value="${parameters.a}" 
                               onInput="updateParameter('a', this.value)" id="aSlider">
                        <input type="number" class="parameter-input" min="-3" max="3" step="0.1" value="${parameters.a}" 
                               onInput="updateParameter('a', this.value)" id="aInput">
                    </div>
                    
                    <div class="parameter-group">
                        <label class="parameter-label">Desplazamiento X (h)</label>
                        <input type="range" class="slider" min="-5" max="5" step="0.1" value="${parameters.h}" 
                               onInput="updateParameter('h', this.value)" id="hSlider">
                        <input type="number" class="parameter-input" min="-5" max="5" step="0.1" value="${parameters.h}" 
                               onInput="updateParameter('h', this.value)" id="hInput">
                    </div>
                    
                    <div class="parameter-group">
                        <label class="parameter-label">Desplazamiento Y (k)</label>
                        <input type="range" class="slider" min="-10" max="10" step="0.1" value="${parameters.k}" 
                               onInput="updateParameter('k', this.value)" id="kSlider">
                        <input type="number" class="parameter-input" min="-10" max="10" step="0.1" value="${parameters.k}" 
                               onInput="updateParameter('k', this.value)" id="kInput">
                    </div>
                `;
            }
        }

        // Actualizar par√°metro
        function updateParameter(param, value) {
            parameters[param] = parseFloat(value);
            
            // Sincronizar slider e input
            const slider = document.getElementById(param + 'Slider');
            const input = document.getElementById(param + 'Input');
            if (slider) slider.value = value;
            if (input) input.value = value;
            
            updateGraph();
            updateEquation();
        }

        // Actualizar ecuaci√≥n mostrada
        function updateEquation() {
            const equationElement = document.getElementById('currentEquation');
            let equation = '';
            
            if (currentFunction === 'linear') {
                const m = parameters.m.toFixed(1);
                const b = parameters.b.toFixed(1);
                const bStr = parameters.b >= 0 ? `+ ${b}` : `- ${Math.abs(parameters.b).toFixed(1)}`;
                equation = `y = ${m}x ${bStr}`;
            } else {
                const a = parameters.a.toFixed(1);
                const h = parameters.h.toFixed(1);
                const k = parameters.k.toFixed(1);
                const kStr = parameters.k >= 0 ? `+ ${k}` : `- ${Math.abs(parameters.k).toFixed(1)}`;
                equation = `y = ${a}(x - ${h})¬≤ ${kStr}`;
            }
            
            equationElement.textContent = equation;
        }

        // Actualizar gr√°fico
        function updateGraph() {
            const canvas = document.getElementById('graphCanvas');
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            
            // Limpiar canvas
            ctx.fillStyle = 'rgba(0, 20, 40, 0.9)';
            ctx.fillRect(0, 0, width, height);
            
            // Configuraci√≥n del plano cartesiano
            const centerX = width / 2;
            const centerY = height / 2;
            const scale = 20; // pixeles por unidad
            
            // Dibujar cuadr√≠cula
            drawGrid(ctx, width, height, centerX, centerY, scale);
            
            // Dibujar ejes
            drawAxes(ctx, width, height, centerX, centerY);
            
            // Dibujar funci√≥n
            if (currentFunction === 'linear') {
                drawLinearFunction(ctx, centerX, centerY, scale);
            } else {
                drawQuadraticFunction(ctx, centerX, centerY, scale);
            }
            
            // Dibujar puntos de referencia si es necesario para el desaf√≠o actual
            drawChallengePoints(ctx, centerX, centerY, scale);
        }

        // Dibujar cuadr√≠cula
        function drawGrid(ctx, width, height, centerX, centerY, scale) {
            ctx.strokeStyle = 'rgba(0, 255, 255, 0.2)';
            ctx.lineWidth = 1;
            
            // L√≠neas verticales
            for (let x = centerX % scale; x < width; x += scale) {
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, height);
                ctx.stroke();
            }
            
            // L√≠neas horizontales
            for (let y = centerY % scale; y < height; y += scale) {
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(width, y);
                ctx.stroke();
            }
        }

        // Dibujar ejes
        function drawAxes(ctx, width, height, centerX, centerY) {
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.8)';
            ctx.lineWidth = 2;
            
            // Eje X
            ctx.beginPath();
            ctx.moveTo(0, centerY);
            ctx.lineTo(width, centerY);
            ctx.stroke();
            
            // Eje Y
            ctx.beginPath();
            ctx.moveTo(centerX, 0);
            ctx.lineTo(centerX, height);
            ctx.stroke();
            
            // Etiquetas de los ejes
            ctx.fillStyle = 'white';
            ctx.font = '14px Orbitron';
            ctx.textAlign = 'center';
            
            // N√∫meros en eje X
            for (let i = -10; i <= 10; i++) {
                if (i !== 0) {
                    const x = centerX + i * 20;
                    if (x >= 0 && x <= width) {
                        ctx.fillText(i.toString(), x, centerY + 20);
                    }
                }
            }
            
            // N√∫meros en eje Y
            ctx.textAlign = 'right';
            for (let i = -10; i <= 10; i++) {
                if (i !== 0) {
                    const y = centerY - i * 20;
                    if (y >= 0 && y <= height) {
                        ctx.fillText(i.toString(), centerX - 10, y + 5);
                    }
                }
            }
        }

        // Dibujar funci√≥n lineal
        function drawLinearFunction(ctx, centerX, centerY, scale) {
            const m = parameters.m;
            const b = parameters.b;
            
            ctx.strokeStyle = '#00ffff';
            ctx.lineWidth = 3;
            ctx.shadowColor = '#00ffff';
            ctx.shadowBlur = 10;
            
            ctx.beginPath();
            
            const startX = -centerX / scale;
            const endX = (ctx.canvas.width - centerX) / scale;
            
            for (let x = startX; x <= endX; x += 0.1) {
                const y = m * x + b;
                const canvasX = centerX + x * scale;
                const canvasY = centerY - y * scale;
                
                if (x === startX) {
                    ctx.moveTo(canvasX, canvasY);
                } else {
                    ctx.lineTo(canvasX, canvasY);
                }
            }
            
            ctx.stroke();
            ctx.shadowBlur = 0;
        }

        // Dibujar funci√≥n cuadr√°tica
        function drawQuadraticFunction(ctx, centerX, centerY, scale) {
            const a = parameters.a;
            const h = parameters.h;
            const k = parameters.k;
            
            ctx.strokeStyle = '#ff00ff';
            ctx.lineWidth = 3;
            ctx.shadowColor = '#ff00ff';
            ctx.shadowBlur = 10;
            
            ctx.beginPath();
            
            const startX = -centerX / scale;
            const endX = (ctx.canvas.width - centerX) / scale;
            
            let firstPoint = true;
            for (let x = startX; x <= endX; x += 0.05) {
                const y = a * Math.pow(x - h, 2) + k;
                const canvasX = centerX + x * scale;
                const canvasY = centerY - y * scale;
                
                if (canvasY >= -50 && canvasY <= ctx.canvas.height + 50) {
                    if (firstPoint) {
                        ctx.moveTo(canvasX, canvasY);
                        firstPoint = false;
                    } else {
                        ctx.lineTo(canvasX, canvasY);
                    }
                }
            }
            
            ctx.stroke();
            ctx.shadowBlur = 0;
            
            // Dibujar v√©rtice
            const vertexX = centerX + h * scale;
            const vertexY = centerY - k * scale;
            
            ctx.fillStyle = '#ffff00';
            ctx.beginPath();
            ctx.arc(vertexX, vertexY, 6, 0, 2 * Math.PI);
            ctx.fill();
        }

        // Dibujar puntos del desaf√≠o
        function drawChallengePoints(ctx, centerX, centerY, scale) {
            const challenge = challenges[gameState.currentChallenge];
            if (!challenge || !challenge.points) return;
            
            ctx.fillStyle = '#ffff00';
            ctx.strokeStyle = '#ffffff';
            ctx.lineWidth = 2;
            
            if (challenge.points) {
                challenge.points.forEach(point => {
                    const canvasX = centerX + point.x * scale;
                    const canvasY = centerY - point.y * scale;
                    
                    ctx.beginPath();
                    ctx.arc(canvasX, canvasY, 8, 0, 2 * Math.PI);
                    ctx.fill();
                    ctx.stroke();
                    
                    // Etiqueta del punto
                    ctx.fillStyle = 'white';
                    ctx.font = '12px Orbitron';
                    ctx.textAlign = 'center';
                    ctx.fillText(`(${point.x}, ${point.y})`, canvasX, canvasY - 15);
                    ctx.fillStyle = '#ffff00';
                });
            }
        }

        // Verificar desaf√≠o
        function checkChallenge() {
            const challenge = challenges[gameState.currentChallenge];
            const tolerance = challenge.tolerance;
            let isCorrect = true;
            
            if (challenge.type === 'linear') {
                const mDiff = Math.abs(parameters.m - challenge.target.m);
                const bDiff = Math.abs(parameters.b - challenge.target.b);
                isCorrect = mDiff <= tolerance && bDiff <= tolerance;
            } else if (challenge.type === 'quadratic') {
                if (challenge.target.a !== undefined) {
                    const aDiff = Math.abs(parameters.a - challenge.target.a);
                    isCorrect = isCorrect && aDiff <= tolerance;
                }
                if (challenge.target.h !== undefined) {
                    const hDiff = Math.abs(parameters.h - challenge.target.h);
                    isCorrect = isCorrect && hDiff <= tolerance;
                }
                if (challenge.target.k !== undefined) {
                    const kDiff = Math.abs(parameters.k - challenge.target.k);
                    isCorrect = isCorrect && kDiff <= tolerance;
                }
                if (challenge.target.b !== undefined) {
                    const bDiff = Math.abs(parameters.b - challenge.target.b);
                    isCorrect = isCorrect && bDiff <= tolerance;
                }
                if (challenge.target.c !== undefined) {
                    const cDiff = Math.abs(parameters.k - challenge.target.c);
                    isCorrect = isCorrect && cDiff <= tolerance;
                }
            }
            
            const feedbackElement = document.getElementById('feedback');
            
            if (isCorrect) {
                feedbackElement.className = 'feedback correct';
                feedbackElement.textContent = '¬°Excelente! Has resuelto el desaf√≠o correctamente. üöÄ';
                
                // Actualizar puntuaci√≥n
                gameState.score += challenge.points;
                gameState.challenges++;
                gameState.streak++;
                
                // Verificar logros
                checkAchievements();
                
                // Avanzar al siguiente desaf√≠o
                setTimeout(() => {
                    nextChallenge();
                }, 2000);
                
            } else {
                feedbackElement.className = 'feedback incorrect';
                feedbackElement.textContent = 'A√∫n no es correcto. Revisa los par√°metros e int√©ntalo de nuevo. üîç';
                gameState.streak = 0;
            }
            
            updateUI();
        }

        // Mostrar pista
        function showHint() {
            const challenge = challenges[gameState.currentChallenge];
            const feedbackElement = document.getElementById('feedback');
            feedbackElement.className = 'feedback';
            feedbackElement.style.background = 'rgba(255, 255, 0, 0.2)';
            feedbackElement.style.color = '#ffff00';
            feedbackElement.style.border = '1px solid #ffff00';
            feedbackElement.textContent = 'üí° ' + challenge.hint;
        }

        // Siguiente desaf√≠o
        function nextChallenge() {
            gameState.currentChallenge++;
            if (gameState.currentChallenge >= challenges.length) {
                // Juego completado
                showGameComplete();
                return;
            }
            
            updateChallenge();
            document.getElementById('feedback').textContent = '';
            document.getElementById('feedback').className = 'feedback';
        }

        // Actualizar desaf√≠o actual
        function updateChallenge() {
            const challenge = challenges[gameState.currentChallenge];
            const challengeElement = document.getElementById('currentChallenge');
            
            challengeElement.innerHTML = `
                <div class="challenge-title">${challenge.title}</div>
                <div class="challenge-description">${challenge.description}</div>
                <button class="check-btn" onclick="checkChallenge()">Verificar Soluci√≥n</button>
                <button class="hint-btn" onclick="showHint()">üí° Pista</button>
                <div class="feedback" id="feedback"></div>
            `;
            
            // Cambiar a la funci√≥n correcta
            if (challenge.type !== currentFunction) {
                selectFunction(challenge.type);
            }
            
            // Agregar puntos de referencia si los hay
            if (challenge.title.includes("puntos")) {
                if (challenge.target.m === 2 && challenge.target.b === 2) {
                    challenge.points = [{x: 0, y: 2}, {x: 2, y: 6}];
                }
            }
        }

        // Verificar logros
        function checkAchievements() {
            // Primer gr√°fico
            if (!achievements[0].unlocked && gameState.challenges >= 1) {
                unlockAchievement(0);
            }
            
            // Maestro lineal
            if (!achievements[1].unlocked && gameState.challenges >= 2) {
                unlockAchievement(1);
            }
            
            // Explorador de curvas
            if (!achievements[2].unlocked && gameState.challenges >= 3) {
                unlockAchievement(2);
            }
            
            // Racha perfecta
            if (!achievements[3].unlocked && gameState.streak >= 3) {
                unlockAchievement(3);
            }
            
            // Navegante espacial
            if (!achievements[4].unlocked && gameState.challenges >= 5) {
                unlockAchievement(4);
            }
        }

        // Desbloquear logro
        function unlockAchievement(index) {
            achievements[index].unlocked = true;
            gameState.score += 50; // Bonus por logro
            
            // Mostrar notificaci√≥n
            showNotification(`¬°Logro desbloqueado: ${achievements[index].name}! ${achievements[index].icon}`);
            
            updateUI();
        }

        // Mostrar notificaci√≥n
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.style.position = 'fixed';
            notification.style.top = '20px';
            notification.style.right = '20px';
            notification.style.background = 'linear-gradient(45deg, #00ff00, #00ffff)';
            notification.style.color = 'black';
            notification.style.padding = '15px 25px';
            notification.style.borderRadius = '10px';
            notification.style.fontFamily = 'Orbitron, monospace';
            notification.style.fontWeight = '600';
            notification.style.zIndex = '1000';
            notification.style.transform = 'translateX(100%)';
            notification.style.transition = 'transform 0.5s ease';
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
            }, 100);
            
            setTimeout(() => {
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => notification.remove(), 500);
            }, 3000);
        }

        // Actualizar interfaz
        function updateUI() {
            document.getElementById('score').textContent = gameState.score;
            document.getElementById('level').textContent = Math.floor(gameState.score / 500) + 1;
            document.getElementById('challenges').textContent = gameState.challenges;
            document.getElementById('streak').textContent = gameState.streak;
            
            // Actualizar logros
            const achievementsContainer = document.getElementById('achievements');
            achievementsContainer.innerHTML = '';
            
            achievements.forEach(achievement => {
                if (achievement.unlocked) {
                    const achievementElement = document.createElement('div');
                    achievementElement.className = 'achievement';
                    achievementElement.textContent = achievement.icon;
                    achievementElement.title = achievement.name;
                    achievementsContainer.appendChild(achievementElement);
                }
            });
        }

        // Mostrar completaci√≥n del juego
        function showGameComplete() {
            const challengeElement = document.getElementById('currentChallenge');
            challengeElement.innerHTML = `
                <div class="challenge-title">üéâ ¬°Felicitaciones, Navegante Espacial! üéâ</div>
                <div class="challenge-description">
                    Has completado todos los desaf√≠os del Graficador Espacial. Has demostrado un excelente dominio de las funciones lineales y cuadr√°ticas.
                    <br><br>
                    <strong>Puntuaci√≥n Final:</strong> ${gameState.score} puntos<br>
                    <strong>Desaf√≠os Completados:</strong> ${gameState.challenges}/5<br>
                    <strong>Logros Desbloqueados:</strong> ${achievements.filter(a => a.unlocked).length}/${achievements.length}
                    <br><br>
                    ¬°Sigue explorando el fascinante mundo de las matem√°ticas!
                </div>
                <button class="check-btn" onclick="resetGame()">üîÑ Jugar de Nuevo</button>
            `;
        }

        // Reiniciar juego
        function resetGame() {
            gameState = {
                score: 0,
                level: 1,
                challenges: 0,
                streak: 0,
                currentChallenge: 0
            };
            
            achievements.forEach(a => a.unlocked = false);
            
            parameters = { m: 1, b: 0, a: 1, h: 0, k: 0 };
            currentFunction = 'linear';
            
            selectFunction('linear');
            updateChallenge();
            updateUI();
        }

        // Eventos de redimensionamiento
        window.addEventListener('resize', function() {
            setTimeout(() => {
                initializeCanvas();
                updateGraph();
            }, 100);
        });
    </script>
</body>
</html>